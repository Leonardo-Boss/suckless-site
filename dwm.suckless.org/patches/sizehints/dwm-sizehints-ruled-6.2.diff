From 0ddf28f0fa3285d7c75cb9493ce82075b7819564 Mon Sep 17 00:00:00 2001
From: MLquest8 <miskuzius@gmail.com>
Date: Fri, 12 Jun 2020 17:28:03 +0400
Subject: [PATCH] sizehints version which obeys "isfloating" rule. Version 6.2

---
 dwm.c | 12 +++++++++++-
 1 file changed, 11 insertions(+), 1 deletion(-)

diff --git a/dwm.c b/dwm.c
index 9fd0286..0205e29 100644
--- a/dwm.c
+++ b/dwm.c
@@ -1947,12 +1947,14 @@ updatenumlockmask(void)
 void
 updatesizehints(Client *c)
 {
+	int i;
 	long msize;
+	const Rule *r;
 	XSizeHints size;
 
 	if (!XGetWMNormalHints(dpy, c->win, &size, &msize))
 		/* size is uninitialized, ensure that size.flags aren't used */
-		size.flags = PSize;
+		size.flags = 0;
 	if (size.flags & PBaseSize) {
 		c->basew = size.base_width;
 		c->baseh = size.base_height;
@@ -1984,6 +1986,14 @@ updatesizehints(Client *c)
 		c->maxa = (float)size.max_aspect.x / size.max_aspect.y;
 	} else
 		c->maxa = c->mina = 0.0;
+	for (i = 0; i < LENGTH(rules); i++) {
+		r = &rules[i];
+		if((size.flags & PSize) && (r->isfloating != 0)) {
+			c->basew = size.base_width;
+			c->baseh = size.base_height;
+			c->isfloating = True;
+		}
+	}
 	c->isfixed = (c->maxw && c->maxh && c->maxw == c->minw && c->maxh == c->minh);
 }
 
-- 
2.26.2

